name: Release

# Trigger this workflow only when a new Git tag starting with 'v' is pushed (e.g., v1.0.0)
on:
  push:
    tags:
      - v*

# Cancel any in-progress runs if a new tag is pushed for the same release group
concurrency:
  group: "release-${{ github.head_ref || github.ref }}"
  cancel-in-progress: true

jobs:
  # Final Step: Build and push multi-arch container images to GHCR
  build-and-push-container:
    name: Build and Push Container Image
    uses: ./.github/workflows/build-container.yml
    permissions:
      packages: write
